\newcommand{\MrrAndMapResultsTable}{
    \begin{table}[H]
        \centering
        \begin{tabular}{|p{2,8cm}||p{2,8cm} p{2,8cm} p{2,8cm}|}
            \hline
            & ALOHA & Joint Embedding & Proposed Model \\
            \hline
            MRR & - & 0.234$\pm$0.028 & \textBF{0.280$\pm$0.042} \\
            MAP & - & 0.105$\pm$0.001 & \textBF{0.106$\pm$0.000} \\
            \hline
        \end{tabular}
        \caption{Mean and standard deviation MRR (Mean Reciprocal Rank) and MAP (Mean Average Precision) results for the different models on the Family Ranking task. Results were aggregated over \textBF{3} training runs with different weight initializations and minibatch orderings. Best results are shown in \textbf{bold}.} \label{tab:MrrAndMapResults}
    \end{table}
}

\newcommand{\maxApExampleRankTable}{
    \begin{table}[H]
        \centering
        \begin{tabular}{|p{1,5cm}||p{1,5cm} p{1cm} p{1,8cm}|p{1,5cm} p{1cm} p{1,8cm}|}
            \hline
            Max AP & \multicolumn{3}{c|}{Joint Embedding} & \multicolumn{3}{c|}{Proposed Model} \\
            & Sha256 & Label & Family & Sha256 & Label & Family \\
            \hline
            Query & 279ef4.. & 7 & remcosrat & dce197.. & 6 & njrat \\
            \hline
            0 & 4c0ccf.. & 4 & loki & febe75.. & 1 & agenttesla \\
			1 & \textBF{0e67ac}.. & \textBF{7} & \textBF{remcosrat} & 3638ac.. & 2 & formbook \\
			2 & ec21d1.. & 1 & agenttesla & 3a79f3.. & 1 & agenttesla \\
			3 & 9b1d91.. & 3 & masslogger & \textBF{8e24e1}.. & \textBF{6} & \textBF{njrat} \\
			4 & \textBF{714f5b}.. & \textBF{7} & \textBF{remcosrat} & 6ac164.. & 0 & heodo \\
			5 & 481e26.. & 1 & agenttesla & a68641.. & 0 & heodo \\
			6 & 36a4c2.. & 3 & masslogger & 93b306.. & 4 & loki \\
			7 & 4ce1f9.. & 2 & formbook & 60c1ea.. & 2 & formbook \\
			8 & c92d02.. & 8 & netwire & a9b965.. & 3 & masslogger \\
			9 & 007b98.. & 9 & azorult & ac6dfb.. & 4 & loki \\
            \hline
        \end{tabular}
        \caption{\textBF{Joint Embedding} and \textBF{Proposed Model} example rankings (limited to the first 10 samples) having the maximum Average Precision (max AP). The elements matching the query sample are shown in \textbf{bold}. The next occurrence of family '\textBF{remcosrat}' in the joint Embedding ranking is at positions \textBF{20}. On the other hand, the next occurrence of family '\textBF{njrat}' in the Proposed Model ranking is at position \textBF{17}.} \label{tab:maxApExampleRank}
    \end{table}
}

\newcommand{\maxRrExampleRankTable}{
    \begin{table}[H]
        \centering
        \begin{tabular}{|p{1,5cm}||p{1,5cm} p{1cm} p{1,8cm}|p{1,5cm} p{1cm} p{1,8cm}|}
            \hline
            Max RR & \multicolumn{3}{c|}{Joint Embedding} & \multicolumn{3}{c|}{Proposed Model} \\
            & Sha256 & Label & Family & Sha256 & Label & Family \\
            \hline
            Query & 99de7c.. & 4 & loki & d6ff33.. & 1 & agenttesla \\
            \hline
            0 & \textBF{4c0ccf}.. & \textBF{4} & \textBF{loki} & \textBF{febe75}.. & \textBF{1} & \textBF{agenttesla} \\
			1 & 0e67ac.. & 7 & remcosrat & 3638ac.. & 2 & formbook \\
			2 & ec21d1.. & 1 & agenttesla & \textBF{3a79f3}.. & \textBF{1} & \textBF{agenttesla} \\
			3 & 9b1d91.. & 3 & masslogger & 8e24e1.. & 6 & njrat \\
			4 & 714f5b.. & 7 & remcosrat & 6ac164.. & 0 & heodo \\
			5 & 481e26.. & 1 & agenttesla & a68641.. & 0 & heodo \\
			6 & 36a4c2.. & 3 & masslogger & ccbf0e.. & 4 & loki \\
			7 & 4ce1f9.. & 2 & formbook & 1e17f4.. & 3 & masslogger \\
			8 & c92d02.. & 8 & netwire & 9aee92.. & 9 & azorult \\
			9 & 007b98.. & 9 & azorult & 0ad577.. & 6 & njrat \\
            \hline
        \end{tabular}
        \caption{\textBF{Joint Embedding} and \textBF{Proposed Model} example rankings (limited to the first 10 samples) having the maximum Reciprocal Rank (max RR). The elements matching the query sample are shown in \textbf{bold}. The next occurrence of family '\textBF{loki}' in the joint Embedding ranking is at positions \textBF{31}. On the other hand, the next occurrence of family '\textBF{agenttesla}' in the Proposed Model ranking is at position \textBF{21}.} \label{tab:maxRrExampleRank}
    \end{table}
}

\newcommand{\minApExampleRankTable}{
    \begin{table}[H]
        \centering
        \begin{tabular}{|p{1,5cm}||p{1,5cm} p{1cm} p{1,8cm}|p{1,5cm} p{1cm} p{1,8cm}|}
            \hline
            Min AP & \multicolumn{3}{c|}{Joint Embedding} & \multicolumn{3}{c|}{Proposed Model} \\
            & Sha256 & Label & Family & Sha256 & Label & Family \\
            \hline
            Query & 0ce4f6.. & 9 & azorult & 5ba2e4.. & 5 & avemariarat \\
            \hline
            0 & 4c0ccf.. & 4 & loki & febe75.. & 1 & agenttesla \\
			1 & 0e67ac.. & 7 & remcosrat & 3638ac.. & 2 & formbook \\
			2 & ec21d1.. & 1 & agenttesla & 3a79f3.. & 1 & agenttesla \\
			3 & 9b1d91.. & 3 & masslogger & 8e24e1.. & 6 & njrat \\
			4 & 714f5b.. & 7 & remcosrat & 6ac164.. & 0 & heodo \\
			5 & 481e26.. & 1 & agenttesla & a68641.. & 0 & heodo \\
			6 & 36a4c2.. & 3 & masslogger & ccbf0e.. & 4 & loki \\
			7 & 4ce1f9.. & 2 & formbook & 1e17f4.. & 3 & masslogger \\
			8 & c92d02.. & 8 & netwire & 9aee92.. & 9 & azorult \\
			9 & \textBF{007b98}.. & \textBF{9} & \textBF{azorult} & 0ad577.. & 6 & njrat \\
            \hline
        \end{tabular}
        \caption{\textBF{Joint Embedding} and \textBF{Proposed Model} example rankings (limited to the first 10 samples) having the minimum Average Precision (min AP). The elements matching the query sample are shown in \textbf{bold}. The next occurrence of family '\textBF{azorult}' in the joint Embedding ranking is at positions \textBF{36}. On the other hand, the next occurrence of family '\textBF{avemariarat}' in the Proposed Model ranking is at position \textBF{18}.} \label{tab:minApExampleRank}
    \end{table}
}

\newcommand{\minRrExampleRankTable}{
    \begin{table}[H]
        \centering
        \begin{tabular}{|p{1,5cm}||p{1,5cm} p{1cm} p{1,8cm}|p{1,5cm} p{1cm} p{1,8cm}|}
            \hline
            Min RR & \multicolumn{3}{c|}{Joint Embedding} & \multicolumn{3}{c|}{Proposed Model} \\
            & Sha256 & Label & Family & Sha256 & Label & Family \\
            \hline
            Query & 3416c2.. & 5 & avemariarat & 5ba2e4.. & 5 & avemariarat \\
            \hline
            0 & 4c0ccf.. & 4 & loki & febe75.. & 1 & agenttesla \\
			1 & 0e67ac.. & 7 & remcosrat & 3638ac.. & 2 & formbook \\
			2 & ec21d1.. & 1 & agenttesla & 3a79f3.. & 1 & agenttesla \\
			3 & 9b1d91.. & 3 & masslogger & 8e24e1.. & 6 & njrat \\
			4 & 3d8976.. & 3 & masslogger & 6ac164.. & 0 & heodo \\
			5 & 714f5b.. & 7 & remcosrat & a68641.. & 0 & heodo \\
			6 & 481e26.. & 1 & agenttesla & ccbf0e.. & 4 & loki \\
			7 & 36a4c2.. & 3 & masslogger & 1e17f4.. & 3 & masslogger \\
			8 & cd6e99.. & 6 & njrat & 9aee92.. & 9 & azorult \\
			9 & 4ce1f9.. & 2 & formbook & 0ad577.. & 6 & njrat \\
            \hline
        \end{tabular}
        \caption{\textBF{Joint Embedding} and \textBF{Proposed Model} example rankings (limited to the first 10 samples) having the minimum Reciprocal Rank (min RR). The elements matching the query sample are shown in \textbf{bold}. The next occurrence of family '\textBF{avemariarat}' in the joint Embedding ranking is at positions \textBF{23}. On the other hand, the next occurrence of family '\textBF{avemariarat}' in the Proposed Model ranking is at position \textBF{18}.} \label{tab:minRrExampleRank}
    \end{table}
}