\newcommand{\MrrAndMapResultsTable}{
    \begin{table}[H]
        \centering
        \begin{tabular}{|P{2,8cm}||P{2,2cm} P{2,2cm} P{2,2cm} P{2,2cm}|}
            \hline
            & ALOHA (M/B only) & ALOHA & Joint Embedding & Proposed Model \\
            \hline
            MRR & 0.254$\pm$0.015 & \textBF{0.259$\pm$0.008} & 0.253$\pm$0.012 & 0.253$\pm$0.010 \\
            MAP & 0.106$\pm$0.001 & \textBF{0.106$\pm$0.000} & \textBF{0.106$\pm$0.000} & \textBF{0.106$\pm$0.000} \\
            \hline
        \end{tabular}
        \caption[Family ranking MRR and MAP scores]{Mean and standard deviation MRR (Mean Reciprocal Rank) and MAP (Mean Average Precision) results for the different models on the Family Ranking task. Results were aggregated over \textBF{3} training runs with different weight initializations and minibatch orderings. Best results are shown in \textbf{bold}.} \label{tab:MrrAndMapResults}
    \end{table}
}

\newcommand{\maxApExampleRankTable}{
    \begin{table}[H]
        \centering
        \begin{tabular}{|P{1,8cm}||P{1,7cm} P{1,2cm} P{2cm}|P{1,7cm} P{1,2cm} P{2cm}|}
            \hline
            Max AP & \multicolumn{3}{c|}{ALOHA (M/B)} & \multicolumn{3}{c|}{ALOHA} \\
            & Sha256 & Label & Family & Sha256 & Label & Family \\
            \hline
            Query & 24133d.. & 0 & formbook & e3639a.. & 0 & formbook \\
            \hline
            0 & 8fea1e.. & 3 & quakbot & \textBF{6f16d3}.. & \textBF{0} & \textBF{formbook} \\
			1 & \textBF{02ad1e}.. & \textBF{0} & \textBF{formbook} & \textBF{0655ee}.. & \textBF{0} & \textBF{formbook} \\
			2 & \textBF{8da806}.. & \textBF{0} & \textBF{formbook} & \textBF{40f8cf}.. & \textBF{0} & \textBF{formbook} \\
			3 & 0c95f0.. & 8 & guloader & \textBF{f7c1ec}.. & \textBF{0} & \textBF{formbook} \\
			4 & 95fa71.. & 9 & avemariarat & 620c36.. & 2 & gozi \\
			5 & 4b8466.. & 6 & remcosrat & 38e003.. & 6 & remcosrat \\
			6 & \textBF{191008}.. & \textBF{0} & \textBF{formbook} & \textBF{93e548}.. & \textBF{0} & \textBF{formbook} \\
			7 & 768da5.. & 9 & avemariarat & 1ddaae.. & 4 & loki \\
			8 & \textBF{e92575}.. & \textBF{0} & \textBF{formbook} & 5b9f32.. & 3 & quakbot \\
			9 & f0cae3.. & 3 & quakbot & 83d036.. & 4 & loki \\
            \hline
            Max AP & \multicolumn{3}{c|}{0.186} & \multicolumn{3}{c|}{0.174} \\
            \hline
            Next & \multicolumn{3}{c|}{position 14} & \multicolumn{3}{c|}{position 10} \\
            \hline
            \hline
            Max AP & \multicolumn{3}{c|}{Joint Embedding} & \multicolumn{3}{c|}{Proposed Model} \\
            & Sha256 & Label & Family & Sha256 & Label & Family \\
            \hline
            Query & c0a92a.. & 6 & remcosrat & 389ec4.. & 7 & trickbot \\
            \hline
            0 & \textBF{21f9ef}.. & \textBF{6} & \textBF{remcosrat} & \textBF{aa447e}.. & \textBF{7} & \textBF{trickbot} \\
			1 & \textBF{49c7a5}.. & \textBF{6} & \textBF{remcosrat} & \textBF{cbe743}.. & \textBF{7} & \textBF{trickbot} \\
			2 & f75cb4.. & 2 & gozi & 8dc3da.. & 6 & remcosrat \\
			3 & \textBF{91b004}.. & \textBF{6} & \textBF{remcosrat} & \textBF{e37438}.. & \textBF{7} & \textBF{trickbot} \\
			4 & 2d54d3.. & 3 & quakbot & \textBF{2cadf2}.. & \textBF{7} & \textBF{trickbot} \\
			5 & f86765.. & 9 & avemariarat & 545bc3.. & 8 & guloader \\
			6 & 0ea373.. & 0 & formbook & \textBF{b56a1e}.. & \textBF{7} & \textBF{trickbot} \\
			7 & \textBF{4a9558}.. & \textBF{6} & \textBF{remcosrat} & e14108.. & 6 & remcosrat \\
			8 & 019f79.. & 7 & trickbot & 80e880.. & 2 & gozi \\
			9 & a2f8c1.. & 9 & avemariarat & \textBF{4688b8}.. & \textBF{7} & \textBF{trickbot} \\
            \hline
            Max AP & \multicolumn{3}{c|}{0.190} & \multicolumn{3}{c|}{0.183} \\
            \hline
            Next & \multicolumn{3}{c|}{position 11} & \multicolumn{3}{c|}{position 17} \\
            \hline
        \end{tabular}
        \caption[Family ranking max AP example]{\textBF{ALOHA (M/B) Embedding}, \textBF{ALOHA}, \textBF{Joint Embedding} and \textBF{Proposed Model} example rankings (limited to the first 10 samples) having the maximum Average Precision (max AP). The elements matching the query sample are shown in \textbf{bold}. The last line of each table indicates the position in the ranking where to find the next element belonging to the same family as the query sample.} \label{tab:maxApExampleRank}
    \end{table}
}

\newcommand{\maxRrExampleRankTable}{
    \begin{table}[H]
        \centering
        \begin{tabular}{|P{1,8cm}||P{1,7cm} P{1,2cm} P{2cm}|P{1,7cm} P{1,2cm} P{2cm}|}
            \hline
            Max RR & \multicolumn{3}{c|}{ALOHA (M/B)} & \multicolumn{3}{c|}{ALOHA} \\
            & Sha256 & Label & Family & Sha256 & Label & Family \\
            \hline
            Query & 228f0e.. & 0 & formbook & bcec95.. & 0 & formbook \\
            \hline
            0 & \textBF{f51577}.. & \textBF{0} & \textBF{formbook} & \textBF{7b30aa}.. & \textBF{0} & \textBF{formbook} \\
			1 & d7ece5.. & 3 & quakbot & 2edfad.. & 8 & guloader \\
			2 & 040062.. & 4 & loki & ecdf7d.. & 9 & avemariarat \\
			3 & 80b83b.. & 1 & agenttesla & 74fb06.. & 3 & quakbot \\
			4 & add45f.. & 6 & remcosrat & 0fea0b.. & 7 & trickbot \\
			5 & 608a6d.. & 8 & guloader & 3d4f29.. & 3 & quakbot \\
			6 & 3cb853.. & 6 & remcosrat & b73730.. & 7 & trickbot \\
			7 & fb120a.. & 6 & remcosrat & acf60e.. & 4 & loki \\
			8 & 60984e.. & 1 & agenttesla & a60e97.. & 4 & loki \\
			9 & 457344.. & 6 & remcosrat & 3b2629.. & 7 & trickbot \\
            \hline
            Max RR & \multicolumn{3}{c|}{1.000} & \multicolumn{3}{c|}{1.000} \\
            \hline
            Next & \multicolumn{3}{c|}{position 10} & \multicolumn{3}{c|}{position 11} \\
            \hline
            \hline
            Max RR & \multicolumn{3}{c|}{Joint Embedding} & \multicolumn{3}{c|}{Proposed Model} \\
            & Sha256 & Label & Family & Sha256 & Label & Family \\
            \hline
            Query & 32897c.. & 2 & gozi & 807414.. & 1 & agenttesla \\
            \hline
            0 & \textBF{b4e412}.. & \textBF{2} & \textBF{gozi} & \textBF{d6c10d}.. & \textBF{1} & \textBF{agenttesla} \\
			1 & 0dac03.. & 7 & trickbot & d0dbb5.. & 7 & trickbot \\
			2 & 300ec7.. & 7 & trickbot & 876680.. & 2 & gozi \\
			3 & d9afac.. & 7 & trickbot & 6dba26.. & 7 & trickbot \\
			4 & b1a303.. & 0 & formbook & bd91fc.. & 8 & guloader \\
			5 & b71dc1.. & 7 & trickbot & a31584.. & 6 & remcosrat \\
			6 & 774cff.. & 3 & quakbot & df907a.. & 5 & heodo \\
			7 & 1c8aaa.. & 1 & agenttesla & 3763ee.. & 9 & avemariarat \\
			8 & a6d3dc.. & 1 & agenttesla & 277238.. & 0 & formbook \\
			9 & d01615.. & 1 & agenttesla & 3ad3d1.. & 5 & heodo \\
            \hline
            Max RR & \multicolumn{3}{c|}{1.000} & \multicolumn{3}{c|}{1.000} \\
            \hline
            Next & \multicolumn{3}{c|}{position 12} & \multicolumn{3}{c|}{position 14} \\
            \hline
        \end{tabular}
        \caption[Family ranking max RR example]{\textBF{ALOHA (M/B) Embedding}, \textBF{ALOHA}, \textBF{Joint Embedding} and \textBF{Proposed Model} example rankings (limited to the first 10 samples) having the maximum Reciprocal Rank (max RR). The elements matching the query sample are shown in \textbf{bold}. The last line of each table indicates the position in the ranking where to find the next element belonging to the same family as the query sample.} \label{tab:maxRrExampleRank}
    \end{table}
}
\newcommand{\minApExampleRankTable}{
    \begin{table}[H]
        \centering
        \begin{tabular}{|P{1,8cm}||P{1,7cm} P{1,2cm} P{2cm}|P{1,7cm} P{1,2cm} P{2cm}|}
            \hline
            Min AP & \multicolumn{3}{c|}{ALOHA (M/B)} & \multicolumn{3}{c|}{ALOHA} \\
            & Sha256 & Label & Family & Sha256 & Label & Family \\
            \hline
            Query & f9b156.. & 2 & gozi & ef89d3.. & 8 & guloader \\
            \hline
            0 & c7fc61.. & 6 & remcosrat & 246a1e.. & 3 & quakbot \\
			1 & a5ebcb.. & 5 & heodo & 4a9e32.. & 5 & heodo \\
			2 & 494519.. & 5 & heodo & 84353f.. & 5 & heodo \\
			3 & 4469b2.. & 3 & quakbot & f0125d.. & 2 & gozi \\
			4 & e0c023.. & 0 & formbook & e0e601.. & 1 & agenttesla \\
			5 & a3f0b1.. & 7 & trickbot & 0e20f3.. & 4 & loki \\
			6 & c27598.. & 5 & heodo & 357ab6.. & 6 & remcosrat \\
			7 & 830072.. & 7 & trickbot & f39db6.. & 9 & avemariarat \\
			8 & ca90a8.. & 6 & remcosrat & a98b59.. & 5 & heodo \\
			9 & 341186.. & 7 & trickbot & 719219.. & 7 & trickbot \\
            \hline
            Min AP & \multicolumn{3}{c|}{0.062} & \multicolumn{3}{c|}{0.062} \\
            \hline
            Next & \multicolumn{3}{c|}{position 20} & \multicolumn{3}{c|}{position 39} \\
            \hline
            \hline
            Min AP & \multicolumn{3}{c|}{Joint Embedding} & \multicolumn{3}{c|}{Proposed Model} \\
            & Sha256 & Label & Family & Sha256 & Label & Family \\
            \hline
            Query & c89a67.. & 7 & trickbot & e619c7.. & 3 & quakbot \\
            \hline
            0 & d99c4c.. & 5 & heodo & 71cb97.. & 0 & formbook \\
			1 & b34153.. & 5 & heodo & 10f1ad.. & 1 & agenttesla \\
			2 & 868b30.. & 2 & gozi & 1f1f38.. & 2 & gozi \\
			3 & 3a5181.. & 8 & guloader & 74499f.. & 1 & agenttesla \\
			4 & 6cf9e4.. & 4 & loki & d75380.. & 6 & remcosrat \\
			5 & cf36fa.. & 8 & guloader & d0f6f2.. & 0 & formbook \\
			6 & f2a200.. & 2 & gozi & 7b30aa.. & 0 & formbook \\
			7 & c8eaf6.. & 0 & formbook & 0d0364.. & 6 & remcosrat \\
			8 & e2c837.. & 2 & gozi & ac0afc.. & 6 & remcosrat \\
			9 & 1331f9.. & 0 & formbook & d3d0a5.. & 0 & formbook \\
            \hline
            Min AP & \multicolumn{3}{c|}{0.063} & \multicolumn{3}{c|}{0.065} \\
            \hline
            Next & \multicolumn{3}{c|}{position 67} & \multicolumn{3}{c|}{position 49} \\
            \hline
        \end{tabular}
        \caption[Family ranking min AP example]{\textBF{ALOHA (M/B) Embedding}, \textBF{ALOHA}, \textBF{Joint Embedding} and \textBF{Proposed Model} example rankings (limited to the first 10 samples) having the minimum Average Precision (max AP). The elements matching the query sample are shown in \textbf{bold}. The last line of each table indicates the position in the ranking where to find the next element belonging to the same family as the query sample.} \label{tab:minApExampleRank}
    \end{table}
}

\newcommand{\minRrExampleRankTable}{
    \begin{table}[H]
        \centering
        \begin{tabular}{|P{1,8cm}||P{1,7cm} P{1,2cm} P{2cm}|P{1,7cm} P{1,2cm} P{2cm}|}
            \hline
            Min RR & \multicolumn{3}{c|}{ALOHA (M/B)} & \multicolumn{3}{c|}{ALOHA} \\
            & Sha256 & Label & Family & Sha256 & Label & Family \\
            \hline
            Query & 5f9b8c.. & 8 & guloader & b845b6.. & 1 & agenttesla \\
            \hline
            0 & 90770a.. & 4 & loki & 6c3efe.. & 5 & heodo \\
			1 & f70695.. & 5 & heodo & a09ad5.. & 0 & formbook \\
			2 & 1a778e.. & 5 & heodo & bad7c7.. & 2 & gozi \\
			3 & b0ea42.. & 4 & loki & 18498c.. & 7 & trickbot \\
			4 & 0d77b2.. & 9 & avemariarat & b840f4.. & 0 & formbook \\
			5 & 300dd4.. & 0 & formbook & 3bfc15.. & 6 & remcosrat \\
			6 & a98ba3.. & 0 & formbook & 76cf64.. & 6 & remcosrat \\
			7 & cb5547.. & 6 & remcosrat & 8b6690.. & 9 & avemariarat \\
			8 & 86a419.. & 9 & avemariarat & 31cce8.. & 8 & guloader \\
			9 & 3c2770.. & 2 & gozi & c15a76.. & 2 & gozi \\
            \hline
            Min RR & \multicolumn{3}{c|}{0.008} & \multicolumn{3}{c|}{0.009} \\
            \hline
            Next & \multicolumn{3}{c|}{position 128} & \multicolumn{3}{c|}{position 113} \\
            \hline
            \hline
            Min RR & \multicolumn{3}{c|}{Joint Embedding} & \multicolumn{3}{c|}{Proposed Model} \\
            & Sha256 & Label & Family & Sha256 & Label & Family \\
            \hline
            Query & 4a9e32.. & 5 & heodo & dbfdd9.. & 8 & guloader \\
            \hline
            0 & cedbc9.. & 7 & trickbot & 861dd1.. & 2 & gozi \\
			1 & b48f0a.. & 6 & remcosrat & dca295.. & 3 & quakbot \\
			2 & 174bce.. & 2 & gozi & c89194.. & 1 & agenttesla \\
			3 & 8af585.. & 9 & avemariarat & feb0ce.. & 1 & agenttesla \\
			4 & 4e8a4f.. & 3 & quakbot & 26ee0a.. & 1 & agenttesla \\
			5 & 0558ff.. & 9 & avemariarat & 32e56e.. & 2 & gozi \\
			6 & 7f3487.. & 0 & formbook & 510e00.. & 3 & quakbot \\
			7 & a6e4d5.. & 8 & guloader & d21f7c.. & 6 & remcosrat \\
			8 & 850c25.. & 1 & agenttesla & c3df57.. & 0 & formbook \\
			9 & 853d14.. & 6 & remcosrat & 27bc44.. & 3 & quakbot \\
            \hline
            Min RR & \multicolumn{3}{c|}{0.011} & \multicolumn{3}{c|}{0.009} \\
            \hline
            Next & \multicolumn{3}{c|}{position 94} & \multicolumn{3}{c|}{position 106} \\
            \hline
        \end{tabular}
        \caption[Family ranking min RR example]{\textBF{ALOHA (M/B) Embedding}, \textBF{ALOHA}, \textBF{Joint Embedding} and \textBF{Proposed Model} example rankings (limited to the first 10 samples) having the minimum Reciprocal Rank (max RR). The elements matching the query sample are shown in \textbf{bold}. The last line of each table indicates the position in the ranking where to find the next element belonging to the same family as the query sample.} \label{tab:minRrExampleRank}
    \end{table}
}