\newcommand{\MrrAndMapResultsTable}{
    \begin{table}[H]
        \centering
        \begin{tabular}{|P{1,6cm}||P{2cm} P{2cm} P{2cm} P{2cm} P{2cm}|}
            \hline
            & Ember\newline features & ALOHA\newline (M/B only) & ALOHA & Joint\newline Embedding & Proposed\newline Model \\
            \hline
            MRR & - & - & - & 0.252$\pm$0.029 & \textBF{0.255$\pm$0.024} \\
            MAP & - & - & - & \textBF{0.106$\pm$0.001} & \textBF{0.106$\pm$0.001} \\
            \hline
        \end{tabular}
        \caption[Family ranking MRR and MAP scores]{Mean and standard deviation MRR (Mean Reciprocal Rank) and MAP (Mean Average Precision) results for the different models on the Family Ranking task. Results were aggregated over \textBF{3} training runs with different weight initializations and minibatch orderings. Best results are shown in \textbf{bold}.} \label{tab:MrrAndMapResults}
    \end{table}
}

\newcommand{\maxApExampleRankTable}{
    \begin{table}[H]
        \centering
        \begin{tabular}{|P{1,5cm}||P{1,5cm} P{1cm} P{1,8cm}|P{1,5cm} P{1cm} P{1,8cm}|}
            \hline
            Max AP & \multicolumn{3}{c|}{Joint Embedding} & \multicolumn{3}{c|}{Proposed Model} \\
            & Sha256 & Label & Family & Sha256 & Label & Family \\
            \hline
            Query & f8be22.. & 2 & formbook & e8cac4.. & 7 & remcosrat \\
            \hline
            0 & 3418e1.. & 7 & remcosrat & 351afe.. & 0 & heodo \\
			1 & 63a870.. & 3 & masslogger & 7bcd06.. & 1 & agenttesla \\
			2 & 271006.. & 9 & azorult & \textBF{e8cac4}.. & \textBF{7} & \textBF{remcosrat} \\
			3 & 91069b.. & 1 & agenttesla & 72c2e8.. & 3 & masslogger \\
			4 & 0dcebc.. & 4 & loki & 057883.. & 3 & masslogger \\
			5 & 0ad577.. & 6 & njrat & e1108e.. & 9 & azorult \\
			6 & 13b82d.. & 0 & heodo & e482d2.. & 8 & netwire \\
			7 & cb79b3.. & 0 & heodo & \textBF{46d544}.. & \textBF{7} & \textBF{remcosrat} \\
			8 & 3b8dd3.. & 8 & netwire & 893e86.. & 5 & avemariarat \\
			9 & e124d3.. & 0 & heodo & 8d55fa.. & 9 & azorult \\
            \hline
        \end{tabular}
        \caption[Family ranking max AP example]{\textBF{Joint Embedding} and \textBF{Proposed Model} example rankings (limited to the first 10 samples) having the maximum Average Precision (max AP). The elements matching the query sample are shown in \textbf{bold}. The next occurrence of family '\textBF{formbook}' in the joint Embedding ranking is at positions \textBF{20}. On the other hand, the next occurrence of family '\textBF{remcosrat}' in the Proposed Model ranking is at position \textBF{12}.} \label{tab:maxApExampleRank}
    \end{table}
}

\newcommand{\maxRrExampleRankTable}{
    \begin{table}[H]
        \centering
        \begin{tabular}{|P{1,5cm}||P{1,5cm} P{1cm} P{1,8cm}|P{1,5cm} P{1cm} P{1,8cm}|}
            \hline
            Max RR & \multicolumn{3}{c|}{Joint Embedding} & \multicolumn{3}{c|}{Proposed Model} \\
            & Sha256 & Label & Family & Sha256 & Label & Family \\
            \hline
            Query & 82841c.. & 7 & remcosrat & 963553.. & 0 & heodo \\
            \hline
            0 & \textBF{3418e1}.. & \textBF{7} & \textBF{remcosrat} & \textBF{351afe}.. & \textBF{0} & \textBF{heodo} \\
			1 & 63a870.. & 3 & masslogger & 7bcd06.. & 1 & agenttesla \\
			2 & 271006.. & 9 & azorult & e8cac4.. & 7 & remcosrat \\
			3 & 91069b.. & 1 & agenttesla & 72c2e8.. & 3 & masslogger \\
			4 & 0dcebc.. & 4 & loki & 057883.. & 3 & masslogger \\
			5 & 33be12.. & 5 & avemariarat & e1108e.. & 9 & azorult \\
			6 & 13b82d.. & 0 & heodo & e482d2.. & 8 & netwire \\
			7 & cb79b3.. & 0 & heodo & 46d544.. & 7 & remcosrat \\
			8 & 3b8dd3.. & 8 & netwire & 893e86.. & 5 & avemariarat \\
			9 & e124d3.. & 0 & heodo & 8d55fa.. & 9 & azorult \\
            \hline
        \end{tabular}
        \caption[Family ranking max RR example]{\textBF{Joint Embedding} and \textBF{Proposed Model} example rankings (limited to the first 10 samples) having the maximum Reciprocal Rank (max RR). The elements matching the query sample are shown in \textbf{bold}. The next occurrence of family '\textBF{remcosrat}' in the joint Embedding ranking is at positions \textBF{11}. On the other hand, the next occurrence of family '\textBF{heodo}' in the Proposed Model ranking is at position \textBF{19}.} \label{tab:maxRrExampleRank}
    \end{table}
}

\newcommand{\minApExampleRankTable}{
    \begin{table}[H]
        \centering
        \begin{tabular}{|P{1,5cm}||P{1,5cm} P{1cm} P{1,8cm}|P{1,5cm} P{1cm} P{1,8cm}|}
            \hline
            Min AP & \multicolumn{3}{c|}{Joint Embedding} & \multicolumn{3}{c|}{Proposed Model} \\
            & Sha256 & Label & Family & Sha256 & Label & Family \\
            \hline
            Query & 9a825e.. & 5 & avemariarat & a4a8d0.. & 4 & loki \\
            \hline
            0 & 3418e1.. & 7 & remcosrat & 351afe.. & 0 & heodo \\
			1 & 63a870.. & 3 & masslogger & 7bcd06.. & 1 & agenttesla \\
			2 & 271006.. & 9 & azorult & e8cac4.. & 7 & remcosrat \\
			3 & 91069b.. & 1 & agenttesla & 72c2e8.. & 3 & masslogger \\
			4 & 0dcebc.. & 4 & loki & 057883.. & 3 & masslogger \\
			5 & 0ad577.. & 6 & njrat & e1108e.. & 9 & azorult \\
			6 & 13b82d.. & 0 & heodo & e482d2.. & 8 & netwire \\
			7 & cb79b3.. & 0 & heodo & 46d544.. & 7 & remcosrat \\
			8 & 3b8dd3.. & 8 & netwire & 893e86.. & 5 & avemariarat \\
			9 & e124d3.. & 0 & heodo & 8d55fa.. & 9 & azorult \\
            \hline
        \end{tabular}
        \caption[Family ranking min AP example]{\textBF{Joint Embedding} and \textBF{Proposed Model} example rankings (limited to the first 10 samples) having the minimum Average Precision (min AP). The elements matching the query sample are shown in \textbf{bold}. The next occurrence of family '\textBF{avemariarat}' in the joint Embedding ranking is at positions \textBF{28}. On the other hand, the next occurrence of family '\textBF{loki}' in the Proposed Model ranking is at position \textBF{70}.} \label{tab:minApExampleRank}
    \end{table}
}

\newcommand{\minRrExampleRankTable}{
    \begin{table}[H]
        \centering
        \begin{tabular}{|P{1,5cm}||P{1,5cm} P{1cm} P{1,8cm}|P{1,5cm} P{1cm} P{1,8cm}|}
            \hline
            Min RR & \multicolumn{3}{c|}{Joint Embedding} & \multicolumn{3}{c|}{Proposed Model} \\
            & Sha256 & Label & Family & Sha256 & Label & Family \\
            \hline
            Query & b170f2.. & 5 & avemariarat & a63d9a.. & 4 & loki \\
            \hline
            0 & 3418e1.. & 7 & remcosrat & 351afe.. & 0 & heodo \\
			1 & 63a870.. & 3 & masslogger & 7bcd06.. & 1 & agenttesla \\
			2 & 271006.. & 9 & azorult & e8cac4.. & 7 & remcosrat \\
			3 & 91069b.. & 1 & agenttesla & 72c2e8.. & 3 & masslogger \\
			4 & 0dcebc.. & 4 & loki & 057883.. & 3 & masslogger \\
			5 & 0ad577.. & 6 & njrat & e1108e.. & 9 & azorult \\
			6 & 13b82d.. & 0 & heodo & e482d2.. & 8 & netwire \\
			7 & cb79b3.. & 0 & heodo & 46d544.. & 7 & remcosrat \\
			8 & 3b8dd3.. & 8 & netwire & 893e86.. & 5 & avemariarat \\
			9 & e124d3.. & 0 & heodo & 8d55fa.. & 9 & azorult \\
            \hline
        \end{tabular}
        \caption[Family ranking min RR example]{\textBF{Joint Embedding} and \textBF{Proposed Model} example rankings (limited to the first 10 samples) having the minimum Reciprocal Rank (min RR). The elements matching the query sample are shown in \textbf{bold}. The next occurrence of family '\textBF{avemariarat}' in the joint Embedding ranking is at positions \textBF{28}. On the other hand, the next occurrence of family '\textBF{loki}' in the Proposed Model ranking is at position \textBF{70}.} \label{tab:minRrExampleRank}
    \end{table}
}