\newcommand{\MrrAndMapResultsTable}{
    \begin{table}[H]
        \centering
        \begin{tabular}{|p{2,8cm}||p{2,8cm} p{2,8cm} p{2,8cm}|}
            \hline
            & ALOHA & Joint Embedding & Proposed Model \\
            \hline
            MRR & - & 0.257$\pm$0.024 & \textBF{0.258$\pm$0.055} \\
            MAP & - & 0.104$\pm$0.000 & \textBF{0.106$\pm$0.001} \\
            \hline
        \end{tabular}
        \caption{Mean and standard deviation MRR (Mean Reciprocal Rank) and MAP (Mean Average Precision) results for the different models on the Family Ranking task. Results were aggregated over \textBF{3} training runs with different weight initializations and minibatch orderings. Best results are shown in \textbf{bold}.} \label{tab:MrrAndMapResults}
    \end{table}
}

\newcommand{\maxApExampleRankTable}{
    \begin{table}[H]
        \centering
        \begin{tabular}{|p{1,5cm}||p{1,5cm} p{1cm} p{1,8cm}|p{1,5cm} p{1cm} p{1,8cm}|}
            \hline
            Max AP & \multicolumn{3}{c|}{Joint Embedding} & \multicolumn{3}{c|}{Proposed Model} \\
            & Sha256 & Label & Family & Sha256 & Label & Family \\
            \hline
            Query & 062998.. & 3 & masslogger & f981bf.. & 7 & remcosrat \\
            \hline
            0 & 675242.. & 0 & heodo & b0ca51.. & 9 & azorult \\
			1 & 4fa4ab.. & 7 & remcosrat & 7f534f.. & 0 & heodo \\
			2 & ad7a3b.. & 1 & agenttesla & 05c744.. & 1 & agenttesla \\
			3 & \textBF{dbe304}.. & \textBF{3} & \textBF{masslogger} & 74a643.. & 9 & azorult \\
			4 & bb6469.. & 1 & agenttesla & 4b2197.. & 3 & masslogger \\
			5 & 7d5d03.. & 6 & njrat & a39304.. & 3 & masslogger \\
			6 & 2d25d1.. & 9 & azorult & e830e2.. & 4 & loki \\
			7 & 5759a1.. & 8 & netwire & 90e34c.. & 5 & avemariarat \\
			8 & 417a33.. & 4 & loki & 08424a.. & 5 & avemariarat \\
			9 & f9a1b9.. & 6 & njrat & e201cd.. & 1 & agenttesla \\
            \hline
        \end{tabular}
        \caption{\textBF{Joint Embedding} and \textBF{Proposed Model} example rankings (limited to the first 10 samples) having the maximum Average Precision (max AP). The elements matching the query sample are shown in \textbf{bold}. The next occurrence of family '\textBF{masslogger}' in the joint Embedding ranking is at positions \textBF{16}. On the other hand, the next occurrence of family '\textBF{remcosrat}' in the Proposed Model ranking is at position \textBF{10}.} \label{tab:maxApExampleRank}
    \end{table}
}

\newcommand{\maxRrExampleRankTable}{
    \begin{table}[H]
        \centering
        \begin{tabular}{|p{1,5cm}||p{1,5cm} p{1cm} p{1,8cm}|p{1,5cm} p{1cm} p{1,8cm}|}
            \hline
            Max RR & \multicolumn{3}{c|}{Joint Embedding} & \multicolumn{3}{c|}{Proposed Model} \\
            & Sha256 & Label & Family & Sha256 & Label & Family \\
            \hline
            Query & 14ed06.. & 0 & heodo & 74a643.. & 9 & azorult \\
            \hline
            0 & \textBF{675242}.. & \textBF{0} & \textBF{heodo} & \textBF{b0ca51}.. & \textBF{9} & \textBF{azorult} \\
			1 & 4fa4ab.. & 7 & remcosrat & aa3a40.. & 0 & heodo \\
			2 & ad7a3b.. & 1 & agenttesla & ba8ea2.. & 4 & loki \\
			3 & dbe304.. & 3 & masslogger & cfb34c.. & 4 & loki \\
			4 & bb6469.. & 1 & agenttesla & 27d2b4.. & 1 & agenttesla \\
			5 & 7d5d03.. & 6 & njrat & \textBF{6e4da4}.. & \textBF{9} & \textBF{azorult} \\
			6 & 5759a1.. & 8 & netwire & 31b06c.. & 3 & masslogger \\
			7 & f9a1b9.. & 6 & njrat & 364e72.. & 8 & netwire \\
			8 & 4a41c4.. & 2 & formbook & f8dca3.. & 8 & netwire \\
			9 & 319c36.. & 5 & avemariarat & 264cbd.. & 3 & masslogger \\
            \hline
        \end{tabular}
        \caption{\textBF{Joint Embedding} and \textBF{Proposed Model} example rankings (limited to the first 10 samples) having the maximum Reciprocal Rank (max RR). The elements matching the query sample are shown in \textbf{bold}. The next occurrence of family '\textBF{heodo}' in the joint Embedding ranking is at positions \textBF{15}. On the other hand, the next occurrence of family '\textBF{azorult}' in the Proposed Model ranking is at position \textBF{19}.} \label{tab:maxRrExampleRank}
    \end{table}
}

\newcommand{\minApExampleRankTable}{
    \begin{table}[H]
        \centering
        \begin{tabular}{|p{1,5cm}||p{1,5cm} p{1cm} p{1,8cm}|p{1,5cm} p{1cm} p{1,8cm}|}
            \hline
            Min AP & \multicolumn{3}{c|}{Joint Embedding} & \multicolumn{3}{c|}{Proposed Model} \\
            & Sha256 & Label & Family & Sha256 & Label & Family \\
            \hline
            Query & b09503.. & 3 & masslogger & 1dcadc.. & 6 & njrat \\
            \hline
            0 & 675242.. & 0 & heodo & b0ca51.. & 9 & azorult \\
			1 & 4fa4ab.. & 7 & remcosrat & 7f534f.. & 0 & heodo \\
			2 & 07f934.. & 1 & agenttesla & 74a643.. & 9 & azorult \\
			3 & a9b43a.. & 6 & njrat & 05c744.. & 1 & agenttesla \\
			4 & df2260.. & 2 & formbook & 4b2197.. & 3 & masslogger \\
			5 & e542a2.. & 4 & loki & a39304.. & 3 & masslogger \\
			6 & ca84d6.. & 8 & netwire & e830e2.. & 4 & loki \\
			7 & efe708.. & 8 & netwire & c3ce62.. & 7 & remcosrat \\
			8 & 2b6196.. & 0 & heodo & 90e34c.. & 5 & avemariarat \\
			9 & 92aaa4.. & 7 & remcosrat & 307ca3.. & 0 & heodo \\
            \hline
        \end{tabular}
        \caption{\textBF{Joint Embedding} and \textBF{Proposed Model} example rankings (limited to the first 10 samples) having the minimum Average Precision (min AP). The elements matching the query sample are shown in \textbf{bold}. The next occurrence of family '\textBF{masslogger}' in the joint Embedding ranking is at positions \textBF{16}. On the other hand, the next occurrence of family '\textBF{njrat}' in the Proposed Model ranking is at position \textBF{23}.} \label{tab:minApExampleRank}
    \end{table}
}

\newcommand{\minRrExampleRankTable}{
    \begin{table}[H]
        \centering
        \begin{tabular}{|p{1,5cm}||p{1,5cm} p{1cm} p{1,8cm}|p{1,5cm} p{1cm} p{1,8cm}|}
            \hline
            Min RR & \multicolumn{3}{c|}{Joint Embedding} & \multicolumn{3}{c|}{Proposed Model} \\
            & Sha256 & Label & Family & Sha256 & Label & Family \\
            \hline
            Query & b09503.. & 3 & masslogger & 5f05f0.. & 2 & formbook \\
            \hline
            0 & 675242.. & 0 & heodo & b0ca51.. & 9 & azorult \\
			1 & 4fa4ab.. & 7 & remcosrat & 7f534f.. & 0 & heodo \\
			2 & 07f934.. & 1 & agenttesla & 74a643.. & 9 & azorult \\
			3 & a9b43a.. & 6 & njrat & 05c744.. & 1 & agenttesla \\
			4 & df2260.. & 2 & formbook & 4b2197.. & 3 & masslogger \\
			5 & e542a2.. & 4 & loki & a39304.. & 3 & masslogger \\
			6 & ca84d6.. & 8 & netwire & e830e2.. & 4 & loki \\
			7 & efe708.. & 8 & netwire & 90e34c.. & 5 & avemariarat \\
			8 & 2b6196.. & 0 & heodo & c3ce62.. & 7 & remcosrat \\
			9 & 92aaa4.. & 7 & remcosrat & 6d7571.. & 1 & agenttesla \\
            \hline
        \end{tabular}
        \caption{\textBF{Joint Embedding} and \textBF{Proposed Model} example rankings (limited to the first 10 samples) having the minimum Reciprocal Rank (min RR). The elements matching the query sample are shown in \textbf{bold}. The next occurrence of family '\textBF{masslogger}' in the joint Embedding ranking is at positions \textBF{16}. On the other hand, the next occurrence of family '\textBF{formbook}' in the Proposed Model ranking is at position \textBF{35}.} \label{tab:minRrExampleRank}
    \end{table}
}